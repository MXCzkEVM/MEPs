<pre>  
  MEP: 805
  Title: IoT Data Transmission Over Blockchain
  Status: Draft
  Type: Standards
  Created: 2023-10-21
  Updated: 2023-10-21
</pre>

# MEP-805: IoT Data Transmission Over Blockchain

## Simple Summary

A protocol standardizing the transmission of IoT data using blockchain transaction data messages.

## Abstract

This protocol provides a method to securely and efficiently transmit IoT data through blockchain transactions. It addresses concerns related to data privacy, integrity, efficiency, and scalability while ensuring data is transmitted to its intended recipient.

## Motivation

With the proliferation of IoT devices and the need for secure, transparent, and immutable data transmission, leveraging blockchain technology offers a solution. This protocol aims to standardize this transmission process, ensuring reliability and security.

## Terminology

- **EUI**: End-User Identifier, a unique ID for IoT devices.
- **ERC-6551**: Ethereum's standard for smart contract-based IoT device authentication.
- **LPWAN**: Low Power Wide Area Network, a type of wireless communication tailored for IoT.

## Specification

As per RFC 2119 guidelines:

1. The IoT device's EUI, application ID, device profile ID, tenant ID, and any other relevant IDs present in the JSON message **MUST** be hashed using a collision-resistant cryptographic hash function to ensure privacy.
2. IoT devices using ERC-6551 **SHOULD** sign the data messages. The signed messages **MUST** be sent to the LPWAN treasury address for location proof.
3. Data **MUST** be available on-chain in the data message section by default. If encrypted, only authorized entities **SHOULD** be able to decrypt it.
4. Data **SHOULD** be represented in a compact hex or binary format to minimize on-chain data space.
5. For devices controlled by the same entity, a single ERC-6551 **MAY** authorize and send data to avoid multiple transaction fees.
6. Downlink commands to control devices **MUST** be sent to the LPWAN treasury address with a pre-defined ISO token fee.
7. There **SHALL NOT** be a fallback mechanism in case of IoT network congestion or lack of QoS.

## Interface

```solidity=
pragma solidity ^0.8.0;

/// @title MEP-805 IoT Data Transmission Over Blockchain
interface MEP805 {
  /// @dev Emitted when an IoT device sends data to the blockchain
  event DataTransmitted(address indexed deviceAddress, bytes32 indexed dataHash, uint timestamp);

  /// @dev Emitted when an authorized entity sends a downlink command
  event DownlinkCommandSent(address indexed senderAddress, address indexed deviceAddress, bytes32 commandHash, uint tokenFee);
  
  /// @notice Transmit IoT data to the blockchain
  /// @param dataHash The hash of the IoT data being sent
  function transmitData(bytes32 dataHash) external {}

  /// @notice Send a downlink command to an IoT device
  /// @param deviceAddress The address of the target IoT device
  /// @param commandHash The hash of the command being sent
  /// @param tokenFee The token fee associated with the command
  function sendDownlinkCommand(address deviceAddress, bytes32 commandHash, uint tokenFee) external {}
}

```
## Rationale

By hashing sensitive data, such as device and application-related IDs, signing messages using ERC-6551, and allowing for batched transactions, the protocol ensures data privacy, integrity, and efficiency. It leverages the benefits of blockchain's immutability and transparency to enhance IoT data transmission security.
